[
  {
    "Id": "613728",
    "ThreadId": "257869",
    "Html": "\r\n<p>I need to move some branches around next week if possible. (I&rsquo;ve already put this off longer than I should have by over-researching potential side-effects.)</p>\r\n<p><strong>Planned Rename &#43; Move Actions: </strong></p>\r\n<ol>\r\n<li>Int\\Main &nbsp;&nbsp;&nbsp;&nbsp; to <strong>Dev\\Int</strong> </li><li>QA\\Main &nbsp;&nbsp;&nbsp; to <strong>Mainline\\</strong>Main&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n<em>&nbsp;</em> </li><li>Prod\\Main to <strong>Release\\ProdLegacy </strong><em></em></li></ol>\r\n<p><strong>I have five questions </strong>that I could not answer from reading existing posts on various sites (including this branching guide and great discussion list). Does anyone have</p>\r\n<p><strong>Q1. Any issues </strong>you know of that will mess up our ability to merge existing branches after we rename &#43; move our &ldquo;Dev&rdquo; and &ldquo;Main&rdquo; branches to different subfolders?<strong></strong></p>\r\n<p style=\"padding-left:30px\">For example, <br>\r\nWill RI from child branch /Dev/Feature1 to relocated $/Platform/<strong>Dev/Int </strong>\r\n(previously named $/Platform/Int/Main) cause serious merge issues?<br>\r\nIf yes then what should we expect and will it just be a one-time hit to correct?<br>\r\nWill RI from relocated child branch $/Platform/<strong>Dev/Int</strong> to<strong>\r\n</strong>relocated parent branch $/Platform/Mainline/Main cause serious merge issues?<strong></strong></p>\r\n<p style=\"padding-left:30px\">I&rsquo;ve tried reducing pending and committed changes in child branches, but many things just can&rsquo;t be merged at this time (especially RI Int &agrave; Main).</p>\r\n<p><br>\r\n<strong>Q2. </strong>How strongly would you recommend waiting to rename until after upgrading TFS2010 RTM (&#43;latest updates) to\r\n<strong>SP1</strong>?<strong></strong></p>\r\n<p style=\"padding-left:30px\"><strong><span style=\"color:#00b050\">FYI, I&rsquo;ll be scheduling a consultant to help get our partial TFS-SharePoint configuration uninstalled and then apply TFS2010 SP1.</span></strong></p>\r\n<p><strong></strong><br>\r\n<strong>Q3. Do you agree with ChandruR&rsquo;s steps for <a href=\"http://blogs.msdn.com/b/chandrur/archive/2010/06/09/renaming-branches-in-tfs-2010.aspx\">\r\nrenaming a branch in TFS 2010</a> </strong>- or do you have your own steps (or better yet an example/template script! J)?<strong></strong></p>\r\n<p style=\"padding-left:30px\"><span lang=\"EN\" style=\"color:#333333; font-size:9pt\">&hellip;</span><span lang=\"EN\" style=\"color:#333333; font-size:9pt\"><span style=\"font:7pt 'Times New Roman'\"><br>\r\n</span>i.<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>\r\n</span><span lang=\"EN\" style=\"color:#333333; font-size:9pt\">Merge all changes from the branch you wish to rename to all related branches, check in these merges.</span><span lang=\"EN\" style=\"color:#333333; font-size:9pt\"><span style=\"font:7pt 'Times New Roman'\"><br>\r\n</span>ii.<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span><span lang=\"EN\" style=\"color:#333333; font-size:9pt\">Rename the branch and checkin the rename.</span><span lang=\"EN\" style=\"color:#333333; font-size:9pt\"><span style=\"font:7pt 'Times New Roman'\"><br>\r\n</span>iii.<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span><span lang=\"EN\" style=\"color:#333333; font-size:9pt\">Re-merge to all related branches<br>\r\n</span><span lang=\"EN\" style=\"color:#333333; font-size:9pt\">iv.<span style=\"font:7pt 'Times New Roman'\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n</span></span><span lang=\"EN\" style=\"color:#333333; font-size:9pt\">Look at any items which have a merge, undelete from step c). Undo the merge on them and re-merge using /discard. e.g. if $/proj/target/1.txt has a merge, undelete on it</span></p>\r\n<p><br>\r\n<strong>Q4. Can we treat the original ancestor branch as a child branch</strong> (just reversing the term RI and FI) or should we go through steps (and related risks) to reparent renamed ancestor branch?</p>\r\n<p style=\"padding-left:30px\"><span style=\"color:#663300\">* There is a reasonable chance that future livesite hotfixes from the ancestor root branch (soon renamed to\r\n<strong>Release\\ProdLegacy</strong>) will need to be merged back into Main (new root branch). Even though this is the ancestor branch such merges (FIs technically) it should be OK as long as only one Dev has rights to do these merges and RIs from Main to ProdLegacy\r\n are forbidden.</span></p>\r\n<p><br>\r\n<strong>Q5. What happens to shelved changes </strong>if branch is renamed and then changes are unshelved?</p>\r\n<p style=\"padding-left:30px\">My guess is that shelved changes might have the old branch path when unshelved. This could cause a bad move back to original location if checked in?<br>\r\nI think running the shelveset migration Power Tool command on each shelveset might be required to fix up paths for shelveset changes.</p>\r\n<p style=\"padding-left:60px\"><span style=\"color:black; font-size:10pt\">tfpt unshelve [MY_SHELVESET_NAME]\r\n<strong>/migrate</strong> /source:CURRENT_BRANCH_PATH /target:NEW_BRANCH_PATH</span>&nbsp;</p>\r\n<p>Thanks in advance! -<em>Zephan</em></p>\r\n<p>&nbsp;</p>\r\n<p>Below are some additional thoughts and references I used to get as far as I can answering these questions online. Read on if you have spare time AND interest.</p>\r\n<h1>MORE INFORMATION</h1>\r\n<p>My ideal plan would be pretty straightforward:</p>\r\n<ol>\r\n<li>Tell all devs to commit (or delete) shelvesets they own and ask all branch owners to merge what they can before the rename date\r\n<ol>\r\n<li>At least FI (forward integrate) to all child branches to reduce real pre-existing conflicts.\r\n</li><li>Warn all devs what rename will do to their shelvesets and child branches (so they don&rsquo;t get caught by surprise).<br>\r\n<span style=\"color:#800000\"><span style=\"font:7pt 'Times New Roman'\">&nbsp;</span><strong><em>I&rsquo;d love a clear list of known impacts to developers that have shelvesets and locally mapped workspaces before a branch is renamed.</em></strong></span>\r\n<span style=\"color:#800000\">&#65279;</span></li></ol>\r\n</li><li><strong><em></em></strong>Take a full backup of TFS </li><li>Rename &#43; move the 3 branches <br>\r\n<span style=\"color:#800000\"><strong><em>I would like to assume renaming/moving a branch is a fully supported action in TFS2010 that does not trigger unexpected post-move/rename-related merge issues.</em></strong></span>\r\n</li><li>Tell devs to wipe and remap their workspace (so they don&rsquo;t have lingering directory structure confusion).\r\n<br>\r\n<strong><em><span style=\"color:#00b050; font-size:11pt\">I&rsquo;d love to have clear steps and script commands to help devs easily get back to clean working state after a branch rename</span></em></strong>\r\n</li><li>Fix build definitions to point to renamed locations </li><li>Verify clean remapped local machine workspace and build definitions are working, make another backup of TFS, then call the rename a success\r\n</li></ol>\r\n<p>&nbsp;I feel like I&rsquo;m being paranoid, but I haven't gotten a clear sense of how disruptive (=safe/risky) to rename branches is safe in TFS2010 per\r\n<a href=\"http://tfsbranchingguideiii.codeplex.com/discussions/247598\">this 2/25/2011 branching guide discussion</a> (<strong>bold</strong> added for emphasis):</p>\r\n<p><em>&ldquo;&hellip;</em><em><span style=\"color:#30332d; font-size:10pt\">Renaming in and of itself\r\n<strong>might not be bad</strong>. But renaming and then reusing the old name <strong>\r\nmight be something to avoid</strong>.</span>&rdquo;</em></p>\r\n<p>&nbsp;</p>\r\n<h2>Branch Structure Before &amp; After:</h2>\r\n<p><span style=\"text-decoration:underline\">Current structure:</span></p>\r\n<p><span style=\"color:#30332d; font-size:11pt\">$/&lt;Team Project Name&gt;<br>\r\n&nbsp;&nbsp;&nbsp; \\Dev<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \\Dev-Feature1<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &hellip;<br>\r\n&nbsp;&nbsp;&nbsp; \\Int<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \\Main<br>\r\n&nbsp;&nbsp;&nbsp; \\QA<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \\Main&nbsp;&nbsp;</span><span style=\"color:#30332d; font-size:11pt\"><br>\r\n&nbsp;&nbsp;&nbsp; \\Prod<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \\Main&nbsp; <em><span style=\"color:#663300; font-size:11pt\">(Root branch)</span></em></span></p>\r\n<p>&nbsp;</p>\r\n<p><span style=\"text-decoration:underline\">New structure (changes in bold):</span></p>\r\n<p><span style=\"color:#30332d; font-size:11pt\">$/&lt;Team Project Name&gt;<br>\r\n&nbsp;&nbsp;&nbsp; \\Dev<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \\Dev-Feature1<br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <strong>\\Int</strong><br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &hellip;<br>\r\n<strong>&nbsp;&nbsp;&nbsp; \\Mainline</strong><br>\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \\Main&nbsp; </span><em><span style=\"color:#663300; font-size:11pt\">(Root branch - was QA/Main)</span></em><span style=\"color:#30332d; font-size:11pt\"><br>\r\n<strong>&nbsp;&nbsp;&nbsp; \\Release</strong><br>\r\n<strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \\ProdLegacy </strong><em><span style=\"color:#663300; font-size:11pt\">(Root branch - was QA/Main)</span></em></span></p>\r\n<p>&nbsp;</p>\r\n<h2>Branch Renaming discussions:</h2>\r\n<p><strong>1. <a href=\"http://tfsbranchingguideiii.codeplex.com/discussions/247598\">\r\nHow to Transition from Basic to Standard to Advance</a> &ndash; <a href=\"http://tfsbranchingguideiii.codeplex.com/\">\r\ntfsbranchingguideiii.codeplex.com</a> discussion (Bill Heys) &ndash; 2/25/2011</strong></p>\r\n<p style=\"padding-left:30px\"><span style=\"color:#30332d; font-size:10pt\">Like you have seen nothing but problems arise from renaming. Periodically I get cases referred to me from Premier support where things don't seem to be working correctly (merging issues</span><span style=\"color:#30332d; font-size:10pt\">,\r\n upgrade issues from 2008 to 2010, and so on). Almost everyone of these cases has a *hidden* rename issue. Or the user deleted a file and added a different one with the same name. I don't *think* you will have a problem if you follow option one and rename Release\r\n to Service Pack and branch a new Release from it (just don't use exactly the same name as the old banch :), maybe use RTM instead)&nbsp;. So I suppose you will be ok following that course of action.\r\n<strong>Most of the rename issues I have seen have been on the development side. </strong>\r\nI think 2010 handles these situations better so I wouldn't be overly concerned. Renaming in and of itself might not be bad. But renaming and then reusing the old name might be something to avoid.</span></p>\r\n<p>&nbsp;</p>\r\n<p><strong><span style=\"color:black; font-size:11pt\">2. <a href=\"http://blogs.blackmarble.co.uk/blogs/rfennell/archive/2011/02/04/renaming-branches-in-tfs2010.aspx\">\r\n<em><span style=\"color:#2200c1\">Renaming</span></em> branches in <em><span style=\"color:#2200c1\">TFS2010</span></em> - But it works on my PC!</a>&nbsp;<span>blackmarble.co.uk</span></span><span style=\"font-size:11pt\"> &ndash; by Richard Fennell (MVP) on 2/4/2011</span></strong></p>\r\n<p style=\"padding-left:30px\">&ldquo;In TFS 2010 behind the scenes a rename is actually a branch and delete process, this meant we ended up with the new branch, but also a deleted branch of the old name. This is not obvious unless you have &lsquo;show deleted\r\n items in source control explorer&rsquo; enabled&hellip;&rdquo;</p>\r\n<p style=\"padding-left:30px\">Related thread: <span style=\"color:black\"><a href=\"http://social.msdn.microsoft.com/Forums/en-US/tfsversioncontrol/thread/6bb4f327-2603-4397-bfd8-305b0f95cc15/\">Moved items in\r\n<em><span style=\"color:#2200c1\">TFS 2010</span></em> leave 'deleted' ghosts behind</a></span></p>\r\n<p>&nbsp;</p>\r\n<p><strong>3. <a href=\"http://blogs.msdn.com/b/chandrur/archive/2010/06/09/renaming-branches-in-tfs-2010.aspx\">\r\nRenaming Branches in TFS 2010 (ChandruR&rsquo;s Blog)</a> &ndash; by Chandru R. (MSFT) on blogs.msdn.com 6/9/2010</strong></p>\r\n<p style=\"padding-left:30px\">So my recommendations for this case:</p>\r\n<p style=\"padding-left:30px\">1. <strong>Avoid renaming branches</strong> - a cleaner solution&nbsp;would be&nbsp;to, at the right point in your release\r\n<strong>merge all changes to a parent branch and then re-branch </strong>to create a new branch hierarchy.</p>\r\n<p style=\"padding-left:30px\">Or for the brave of heart :)&nbsp;</p>\r\n<p style=\"padding-left:30px\">2. You will need to time the rename of your branch, to a point in your release where you can merge to all related branches. The steps to follow are: (see Q3 above)&hellip;</p>\r\n<p style=\"padding-left:30px\">&nbsp;</p>\r\n<p><strong>4. <a href=\"http://stackoverflow.com/questions/3566490/tfs-2010-wants-to-branch-merge-every-file\">\r\nTFS 2010 wants to branch / merge every file</a>&nbsp;<span lang=\"EN\" style=\"font-size:11pt\">-\r\n</span><span><span style=\"color:black; font-size:11pt\"><a href=\"http://www.stackoverflow.com/\">www.stackoverflow.com</a> thread ~</span></span>8/25/2010</strong></p>\r\n<p style=\"padding-left:30px\">I believe the problem was that we had created the development branches, then deleted them, then recreated them. We ran into a problem similar to this in the past where a file was deleted, then a new file was added with the same\r\n name. The fix for the past problem was to do a baseless merge. Rather than go through that we decided to just delete the development branches and rebranch them with different names.</p>\r\n<p>&nbsp;</p>\r\n<p><strong>5. <a href=\"http://stackoverflow.com/questions/2092863/tfs-overwrite-a-branch-with-another\">\r\nTFS: Overwrite a branch with another</a>&nbsp;- <span><span style=\"color:black; font-size:11pt\"><a href=\"http://www.stackoverflow.com/\">www.stackoverflow.com</a> thread ~</span><span style=\"color:#c00000; font-size:11pt\">1/19/2010</span></span></strong></p>\r\n<p style=\"padding-left:30px\"><span><span style=\"color:black\">&quot;Delete &#43; rebranch in\r\n<em>&lt;TFS&gt;</em> 2005/2008 runs the risk of nightmarish-to-debug namespace conflicts in the future. &quot; - Amen to that!</span></span><span style=\"color:black\"> &ndash;&nbsp;<a title=\"12830 reputation\" href=\"http://stackoverflow.com/users/71059/aakashm\">AakashM</a>\r\n</span><span>Jan 19 '10 at 15:11</span></p>\r\n<p style=\"padding-left:30px\"><span><span style=\"color:black\">No problems that I can think of (apart from the fact that un-deleting the old branch would be difficult if you ever wanted to do that)</span></span><span style=\"color:black\"> &ndash;&nbsp;<a title=\"5883 reputation\" href=\"http://stackoverflow.com/users/6438/martin-woodward\">Martin\r\n Woodward</a> </span><span>Jan 20 '10 at 16:01</span></p>\r\n<p style=\"padding-left:30px\"><em><span style=\"color:windowtext\">(</span></em><em><span style=\"color:#c00000\">*</span></em><em><span style=\"color:windowtext\">Notice date is early 2010 so any TFS2010-specific issues likely unknown at the time.)</span></em><em></em></p>\r\n<p><span style=\"color:black\">&nbsp;</span></p>\r\n<h2>TFS 2010 SP1 rename/move fixes:</h2>\r\n<ul>\r\n<li>A lock on a file is orphaned on check in when the parent is renamed and checked in in another workspace.\r\n</li><li>A candidate delete is lost when you perform a merge in a folder rename. </li><li>When you try to merge a rename and a delete on a file, the results cause inconsistencies in the version control database.\r\n</li><li>When you convert a folder that has subfolders to a branch folder on a hierarchy root folder, and then you rename the folder and its subfolders, Visual Studio crashes.\r\n</li><li>Unshelve reports bogus errors about a null DownloadUrl when dependent renames are shelved, and child item names overlap.\r\n</li><li>An issue in merge causes a conflict not to be generated when there is a rename in the target and source.\r\n</li></ul>\r\n<p>Hopefully the above questions and background research give others a single location to make informed decisions regarding branch renaming. All comments are welcome, so chime in on any pieces or the whole thing.</p>\r\n<p><span style=\"color:#1f497d\">Thanks! - <em>ZephanS</em></span></p>\r\n<p><span style=\"color:#1f497d\">&nbsp;</span></p>\r\n<p><span style=\"color:#1f497d\">(PS: Some content and lots of formatting got lost moving this from an e-mail I drafted. Sorry if I missed anything.)</span></p>\r\n",
    "PostedDate": "2011-05-16T23:47:28.79-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "613881",
    "ThreadId": "257869",
    "Html": "<p>As I mentioned previously in discussions in this forum, renaming files, folders, and branches has been an ongoing source of problems in TFS. Many of these problems were noticed for the first time when migrating from TFS 2008 to TFS 2010 and had to do with the new (slote mode) way of indentifying items in TFS 2010.</p>\r\n<p>Chandru, in his blog, cautions: \"With the switch over to <a href=\"http://blogs.msdn.com/b/mitrik/archive/2009/05/28/changing-to-slot-mode-in-tfs-2010-version-control.aspx\" target=\"_blank\">slot mode</a> in TFS 2010 <strong>renaming branch roots can lead to situations where the next merge from the renamed branch to related branches will generate more than necessary conflic</strong>ts. The reason for this is that when you rename the root of a branch, the source of the rename is considered out of scope of the merge - hence we do not consider the merge history of the source name - so items where the content differs between the source and target since the last merge will be baseless merged. Below is an example which demonstrates this behavior\"</p>\r\n<p>Rather than renaming multiple branches, is it possible to rename/move the branch that will become your new root branch, and create new branches from there?</p>\r\n<p>Regards,<br />Bill Heys<br />VS ALM Ranger</p>",
    "PostedDate": "2011-05-17T05:44:52.847-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "613883",
    "ThreadId": "257869",
    "Html": "<p>I would definitely upgrade to SP1 <strong>before </strong>beginning the rename process.</p>\r\n<p>Bill</p>",
    "PostedDate": "2011-05-17T05:46:47.6-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "614081",
    "ThreadId": "257869",
    "Html": "<p>Bill: Thanks as always for your insights and opinions.</p>\n<p>I forgot to mention that I have at least 6 active developer branches that are children of the current Int/Main branch :-(. I could move QA\\Main to be Mainline\\Main and&nbsp;then branch fresh new structure from this new root node, but I would have several grandchild branches (through another renamed branch) that would effectively produce the same baseless merge situation :-(. I will have to think much harder and act strategically to come up with a process and timeframe when all branches can be merged (or changes abandoned) to do a consolidated rename without lots of loose ends.</p>\n<p>NOTE TO ALL READERS: This isn't just a TFS issue.&nbsp;</p>\n<p style=\"padding-left: 30px;\">I understand it is very challenging to implement branch renaming. For simple branch structures the existing rename functionality is sufficient and quite useful.</p>\n<p style=\"padding-left: 30px;\">I spoke with a CM Dev lead who recently told me that they had equal challenges renaming branches in ClearCase. Their process is what Bill suggests: Create new branch, then branch from that new root branch and obsolete (retire/delete) the old branch. In fact this is what TFS does under the hood (branch source branch to new name, then mark source branch as deleted). The challenge is when you have children of originally named branch (hence Chandru's recommendation to merge all in, then rename).</p>\n<p><strong>TFS FEATURE SUGGESTION:</strong> For 3+ level branch hierarchies I'd recommend a rename warning appear stating next merge with child branches may treat differences as baseless merges. Better yet, consider&nbsp;also creating a branch renaming power tool (check branch depth, then if there are pending changes in children or parent walks the user through steps to inform them (and impacted developers) of potential baseless merges and help guide through steps to mitigate impact of rename (perhaps helping by creating a merge checklist to complete before rename to reduce conflicts).</p>\n<p>&nbsp;</p>\n<p>Remaining questions (anyone is&nbsp;free to answer or comment based on experience):</p>\n<p><strong>Q3. Do you agree with ChandruR&rsquo;s steps for <a href=\"http://blogs.msdn.com/b/chandrur/archive/2010/06/09/renaming-branches-in-tfs-2010.aspx\">renaming a branch in TFS 2010</a> </strong>- or do you have your own steps (or better yet an example/template script!)?</p>\n<p style=\"padding-left: 30px;\">Idea: This looks like a good place for a new \"Branch Rename\" power tool</p>\n<p><span style=\"color: #888888;\"><strong><strong>Q4. Can we treat the original ancestor branch as a child branch</strong> </strong>(just reversing the term RI and FI)... </span>Moving this question to&nbsp;<a href=\"http://tfsbranchingguideiii.codeplex.com/discussions/257972\">a separate discussion post</a>&nbsp;because it&nbsp;is independant of whether a rename is made or not.</p>\n<p><strong>Q5. What happens to shelved changes </strong>if branch is renamed and then changes are unshelved?</p>",
    "PostedDate": "2011-05-17T10:32:39.773-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "614089",
    "ThreadId": "257869",
    "Html": "<p>In and of itself, if you *understand* what happens during a baseless merge, you should be able to manage around it. For example, deletes are not propagated with a baseless merge. This explains some of the Chandru's comments. With a based merge, you can use the history to better understand how the merge should happen. You will know the difference between a file is added to the source branch and not yet merged (added) to the target branch. Or a file is deleted in the source branch and must be deleted from the target branch. Now you understand why baseless merges do NOT propagate deletes. It doesn't have a common base and history to properly identify how to handle a delete.</p>\r\n<p>Similarly when you have changes to a file in both the source and target branches you have merge conflicts to resolve. Without a common base and history, you will simply have more conflicts to understand and resolve.</p>\r\n<p>Once the baseless merge takes place, a new merge relationship is established. Future merges are not baseless.</p>\r\n<p>I am not sure about creating a branch renaming power tool. Doing so might encourage more frequent (reckless) branch renaming. I would prefer to make it painful rather than automatic.</p>\r\n<p>I tend to agree with Chandru's recommended steps for renaming a branch. (Q3)</p>\r\n<p>I see no particular reason why you can't logicall invert the relationship between parent and child (Q4).</p>\r\n<p>I do not know what happens with shelved changes. I might post that question internally and drive for an answer. (Q5).</p>\r\n<p>Regards,<br />Bill Heys<br />VS ALM Ranger</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-05-17T10:50:12.817-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "614095",
    "ThreadId": "257869",
    "Html": "<p>According to Brian Harry, TFS 2010 will handle shelvesets just fine after a branch is subsequently renamed.</p>\r\n<p>Bill</p>",
    "PostedDate": "2011-05-17T10:56:20.697-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "614136",
    "ThreadId": "257869",
    "Html": "<p>Clarification from the product group</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">I want to clarify some behavior here.&nbsp; In TFS 2010 Unshelve will follow pending renames but it will not follow renames committed between when the shelveset was created and the current workspace version.&nbsp; So, let&rsquo;s look at this in two cases.</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">&nbsp;</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">Case 1:</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">&nbsp;</p>\r\n<ol style=\"font-style: normal; margin-top: 0in; unicode-bidi: embed; font-family: Calibri; direction: ltr; margin-bottom: 0in; margin-left: 0.375in; font-size: 11pt; font-weight: normal;\" type=\"1\">\r\n<li style=\"margin-top: 0px; margin-bottom: 0px; vertical-align: middle;\"><span style=\"font-style: normal; font-family: Calibri; color: #1f497d; font-size: 11pt; font-weight: normal;\">In some workspace, an edit is made to $/Proj/Main/foo.txt and is shelved in a shelveset named &ldquo;changes&rdquo;.</span></li>\r\n</ol><ol style=\"font-style: normal; margin-top: 0in; unicode-bidi: embed; font-family: Calibri; direction: ltr; margin-bottom: 0in; margin-left: 0.375in; font-size: 11pt; font-weight: normal;\" type=\"1\">\r\n<li style=\"margin-top: 0px; margin-bottom: 0px; vertical-align: middle;\"><span style=\"font-style: normal; font-family: Calibri; color: #1f497d; font-size: 11pt; font-weight: normal;\">In your workspace, you have a pending rename on the branch such that $/Proj/Main will become $/Proj/Main2010.</span></li>\r\n</ol><ol style=\"font-style: normal; margin-top: 0in; unicode-bidi: embed; font-family: Calibri; direction: ltr; margin-bottom: 0in; margin-left: 0.375in; font-size: 11pt; font-weight: normal;\" type=\"1\">\r\n<li style=\"margin-top: 0px; margin-bottom: 0px; vertical-align: middle;\"><span style=\"font-style: normal; font-family: Calibri; color: #1f497d; font-size: 11pt; font-weight: normal;\">You try to unshelve the shelveset named &ldquo;changes&rdquo; into your workspace.</span></li>\r\n</ol>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">&nbsp;</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">In this case, the change on foo.txt will be unshelved in the local folder that corresponds to $/Proj/Main2010 since that rename is currently pending in your workspace.</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">&nbsp;</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">Case 2:</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">&nbsp;</p>\r\n<ol style=\"font-style: normal; margin-top: 0in; unicode-bidi: embed; font-family: Calibri; direction: ltr; margin-bottom: 0in; margin-left: 0.375in; font-size: 11pt; font-weight: normal;\" type=\"1\">\r\n<li style=\"margin-top: 0px; margin-bottom: 0px; vertical-align: middle;\"><span style=\"font-style: normal; font-family: Calibri; color: #1f497d; font-size: 11pt; font-weight: normal;\">In some workspace, an edit is made to $/Proj/Main/foo.txt and is shelved in a shelveset named &ldquo;changes&rdquo;.</span></li>\r\n</ol><ol style=\"font-style: normal; margin-top: 0in; unicode-bidi: embed; font-family: Calibri; direction: ltr; margin-bottom: 0in; margin-left: 0.375in; font-size: 11pt; font-weight: normal;\" type=\"1\">\r\n<li style=\"margin-top: 0px; margin-bottom: 0px; vertical-align: middle;\"><span style=\"font-style: normal; font-family: Calibri; color: #1f497d; font-size: 11pt; font-weight: normal;\">In your workspace, you pend rename on the branch such that $/Proj/Main will become $/Proj/Main2010.</span></li>\r\n</ol><ol style=\"font-style: normal; margin-top: 0in; unicode-bidi: embed; font-family: Calibri; direction: ltr; margin-bottom: 0in; margin-left: 0.375in; font-size: 11pt; font-weight: normal;\" type=\"1\">\r\n<li style=\"margin-top: 0px; margin-bottom: 0px; vertical-align: middle;\"><span style=\"font-style: normal; font-family: Calibri; color: #1f497d; font-size: 11pt; font-weight: normal;\">You check in your changes to rename $/Proj/Main to $/Proj/Main2010.</span></li>\r\n</ol><ol style=\"font-style: normal; margin-top: 0in; unicode-bidi: embed; font-family: Calibri; direction: ltr; margin-bottom: 0in; margin-left: 0.375in; font-size: 11pt; font-weight: normal;\" type=\"1\">\r\n<li style=\"margin-top: 0px; margin-bottom: 0px; vertical-align: middle;\"><span style=\"font-style: normal; font-family: Calibri; color: #1f497d; font-size: 11pt; font-weight: normal;\">You try to unshelve the shelveset named &ldquo;changes&rdquo;.</span></li>\r\n</ol>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">&nbsp;</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">In this case, the change on foo.txt will be unshelved in the local folder that corresponds to $/Proj/Main and not the newly renamed branch.&nbsp; In order to fix this, you can issue a &ldquo;Get&rdquo; for your workspace.&nbsp; Get will file conflicts that will force you to select the proper location for this change and allow you to move the unshelved changes under the renamed branch.</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">&nbsp;</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">I am happy to say that we will be improving the behavior in case 2 for TFS 2012.</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">&nbsp;</p>\r\n<p style=\"margin: 0in; font-family: Calibri; color: #1f497d; font-size: 11pt;\">Let me know if you have any other questions.</p>",
    "PostedDate": "2011-05-17T11:56:38.587-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "614163",
    "ThreadId": "257869",
    "Html": "<p>Outstanding answers Bill. Thank you for taking the time to answer all my questions in such depth (including clarification of unshelve behavior after related branch rename has been committed).</p>\r\n<p>&nbsp;</p>\r\n<p>Cheers,</p>\r\n<p><em>ZephanS</em></p>",
    "PostedDate": "2011-05-17T12:19:33.653-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "614190",
    "ThreadId": "257869",
    "Html": "<p>One more point from the product group:</p>\r\n<p><span style=\"color: #1f497d;\">If you aren&rsquo;t aware already, renaming branches in TFS 2010 is a very bad idea unless you follow a very specific set of steps:&nbsp; </span><a href=\"http://blogs.msdn.com/b/chandrur/archive/2010/06/09/renaming-branches-in-tfs-2010.aspx\">http://blogs.msdn.com/b/chandrur/archive/2010/06/09/renaming-branches-in-tfs-2010.aspx</a>.</p>\r\n<p>Regards,<br />Bill Heys<br />VS ALM Ranger</p>",
    "PostedDate": "2011-05-17T13:07:09.75-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "614203",
    "ThreadId": "257869",
    "Html": "<p>Chandru's \"Renaming-branches-in-tfs-2010\" link is reference #3 in my original post. I agree it is important enough to point out separately.</p>\n<p>Hmm, on further thought I half-share your preference of renaming being painful over recklessly automated. It would have been really easy for me to nievely renamed my three branches, then wonder why unexpected baseless merge behaviors start occuring sometime later after the rename is forgotten. The dialog (or wizard if multiple screens with logic) I'd like to see would notice I have several other child branches that will be impacted by the rename and present additional information that tells me what kind of pain I might be in for if I choose to continue the rename.</p>\n<p>Rename confirmation dialog:</p>\n<ul>\n<li><strong>Warning:</strong> You have X child branches (excluding deleted branches)&nbsp;that may treat any pending differences as baseless merge the first time you merge with them after renaming this branch. Open the following link for&nbsp;more <a href=\"http://tfsbranchingguideiii.codeplex.com/discussions/257869\" target=\"_blank\">Rename Branch&nbsp;information</a>. </li>\n</ul>\n<p>Branch renaming is probably a good topic to also touch on in the next TFS Branching Guide under branch maintenance.</p>\n<p>Thanks again! - <em>ZephanS</em></p>",
    "PostedDate": "2011-05-17T13:25:23.88-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]